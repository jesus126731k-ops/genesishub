<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesis Hub V2 | Roblox Script</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Arial,sans-serif;background:#000;color:#fff;overflow:hidden;height:100vh}#particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}.particle{position:absolute;width:2px;height:2px;background:rgba(255,255,255,0.8);border-radius:50%;pointer-events:none}.screen{position:absolute;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;z-index:1}.hidden{opacity:0;pointer-events:none;visibility:hidden}#screen1{background:#000}.main-title{font-size:4.5rem;font-weight:900;background:linear-gradient(90deg,#ff6600,#ff3300);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px;text-transform:uppercase;letter-spacing:2px;animation:titledrop 1.2s both;text-shadow:0 5px 15px rgba(255,102,0,0.3)}@keyframes titledrop{0%{transform:translateY(-100px) scale(0.8);opacity:0}100%{transform:translateY(0) scale(1);opacity:1}}.subtitle{font-size:1.5rem;color:#aaa;margin-bottom:50px;animation:subtitlefade 1.5s ease 0.3s both}@keyframes subtitlefade{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}.discord-profiles{display:flex;gap:40px;position:absolute;bottom:40px;animation:profilesfade 1.8s ease 0.6s both}@keyframes profilesfade{0%{opacity:0;transform:translateY(30px)}100%{opacity:1;transform:translateY(0)}}.profile{display:flex;flex-direction:column;align-items:center}.discord-icon{width:60px;height:60px;background:linear-gradient(135deg,#5865F2,#4752c4);border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:10px;box-shadow:0 4px 12px rgba(88,101,242,0.4)}.discord-icon i{font-size:28px}.username{font-size:1.1rem;color:#fff;background:rgba(20,20,20,0.9);padding:6px 15px;border-radius:20px;border:1px solid #333}#screen2{background:#000}.title-section{margin-bottom:60px;animation:titleslide 0.8s ease both}@keyframes titleslide{0%{opacity:0;transform:translateY(-30px)}100%{opacity:1;transform:translateY(0)}}.title-main{font-size:3.5rem;background:linear-gradient(90deg,#ff6600,#ff3300);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px;text-transform:uppercase}.buttons-container{display:flex;flex-direction:column;gap:20px;margin-bottom:80px;animation:buttonsappear 1s ease 0.3s both}@keyframes buttonsappear{0%{opacity:0;transform:scale(0.9)}100%{opacity:1;transform:scale(1)}}.btn{padding:18px 45px;font-size:1.3rem;font-weight:bold;border:none;border-radius:12px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center;gap:12px;min-width:280px;text-transform:uppercase;letter-spacing:1px}.btn:hover{transform:translateY(-3px)}.btn:active{transform:translateY(0)}.btn-key{background:linear-gradient(135deg,#ff6600,#ff3300);color:#fff;box-shadow:0 4px 15px rgba(255,102,0,0.4)}.btn-tutorial{background:linear-gradient(135deg,#333,#666);color:#fff;box-shadow:0 4px 15px rgba(100,100,100,0.4)}.btn-discord{background:linear-gradient(135deg,#5865F2,#4752c4);color:#fff;box-shadow:0 4px 15px rgba(88,101,242,0.4)}.btn i{font-size:1.5rem}.footer-text{position:absolute;bottom:30px;font-size:1rem;color:#666}.key-generator{display:flex;flex-direction:column;align-items:center;max-width:700px;padding:30px;background:rgba(20,20,20,0.95);border-radius:20px;border:1px solid #333;animation:popin 0.5s ease both}@keyframes popin{0%{opacity:0;transform:scale(0.95)}100%{opacity:1;transform:scale(1)}}.key-title{font-size:3rem;background:linear-gradient(90deg,#ff6600,#ff3300);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px;text-transform:uppercase}.key-label{font-size:1.7rem;color:#aaa;margin-bottom:25px}.key-display{width:100%;padding:20px;margin:25px 0;background:rgba(10,10,10,0.9);border-radius:12px;border:1px solid #333;display:flex;flex-direction:column;align-items:center;gap:20px}.key-text{font-family:'Courier New',monospace;font-size:1.8rem;letter-spacing:2px;color:#ff6600;padding:12px 25px;background:rgba(30,15,0,0.8);border-radius:8px;border:1px solid #ff6600;min-width:450px;text-align:center;word-break:break-all}.key-actions{display:flex;gap:15px}.btn-copy{padding:12px 35px;font-size:1.2rem;background:linear-gradient(135deg,#ff6600,#ff3300);color:#fff;border:none;border-radius:8px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:8px;font-weight:bold}.btn-back{padding:12px 35px;font-size:1.2rem;background:#333;color:#fff;border:none;border-radius:8px;cursor:pointer;transition:all 0.2s ease;display:flex;align-items:center;gap:8px;font-weight:bold}.btn-copy:hover,.btn-back:hover{transform:translateY(-2px)}.status-message{margin-top:15px;font-size:1.1rem;color:#aaa;min-height:25px}.loading{display:flex;flex-direction:column;align-items:center;gap:15px}.spinner{width:60px;height:60px;border:4px solid rgba(255,102,0,0.2);border-top:4px solid #ff6600;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.loading-text{font-size:1.3rem;color:#ff6600;animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{opacity:0.7}50%{opacity:1}}@media (max-width:768px){.main-title,.title-main,.key-title{font-size:2.5rem}.btn{min-width:250px;padding:15px 30px;font-size:1.1rem}.key-text{font-size:1.3rem;min-width:300px;padding:10px 15px}.discord-profiles{flex-direction:column;gap:25px}.key-generator{padding:20px;margin:0 15px}}

        .linkvertise-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 2px solid #ff6600;
            box-shadow: 0 10px 30px rgba(255,102,0,0.3);
        }
        
        .modal-title {
            color: #ff6600;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }
        
        .modal-text {
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.5;
            font-size: 1.1rem;
        }
        
        .linkvertise-btn {
            display: inline-block;
            background: linear-gradient(135deg, #ff6600, #ff3300);
            color: white;
            padding: 15px 40px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 15px 0;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .linkvertise-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255,102,0,0.4);
        }
        
        .modal-note {
            color: #888;
            font-size: 0.9rem;
            margin-top: 20px;
            font-style: italic;
        }
        
        .close-modal {
            background: #333;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        
        .close-modal:hover {
            background: #444;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Nuevo estilo para limpiar key */
        .btn-clear {
            padding: 12px 35px;
            font-size: 1.2rem;
            background: linear-gradient(135deg, #ff3300, #cc0000);
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }
        
        .btn-clear:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 51, 0, 0.4);
        }
    </style>
</head>
<body>
    <div id="particles"></div>
    
    <div id="screen1" class="screen">
        <h1 class="main-title">GENESIS HUB V2</h1>
        <h2 class="subtitle">Made by Jes√∫s and Alejandro</h2>
        
        <div class="discord-profiles">
            <div class="profile">
                <div class="discord-icon">
                    <i class="fab fa-discord"></i>
                </div>
                <span class="username">jesusms13</span>
            </div>
            
            <div class="profile">
                <div class="discord-icon">
                    <i class="fab fa-discord"></i>
                </div>
                <span class="username">scriptman83</span>
            </div>
        </div>
    </div>
    
    <div id="screen2" class="screen hidden">
        <div class="title-section">
            <h1 class="title-main">GENESIS HUB V2</h1>
            <p style="color:#aaa;font-size:1.2rem">Premium Roblox Script</p>
        </div>
        
        <div class="buttons-container">
            <button class="btn btn-key" id="createKeyBtn">
                <i class="fas fa-key"></i> CREATE YOUR KEY
            </button>
            
            <button class="btn btn-tutorial" id="tutorialBtn">
                <i class="fas fa-play-circle"></i> TUTORIAL
            </button>
            
            <button class="btn btn-discord" id="discordBtn">
                <i class="fab fa-discord"></i> DISCORD SERVER
            </button>
        </div>
        
        <p class="footer-text">Thank you for using our service!</p>
    </div>
    
    <div id="screen3" class="screen hidden">
        <div class="key-generator">
            <h1 class="key-title">GENESIS HUB V2</h1>
            <h2 class="key-label">YOUR KEY</h2>
            
            <div class="key-display">
                <div id="loadingKey" class="loading">
                    <div class="spinner"></div>
                    <p class="loading-text">Generating your unique key...</p>
                </div>
                
                <div id="keyResult" style="display:none">
                    <div class="key-text" id="generatedKey">ABC12-XYZ34-PQR56</div>
                    <div class="key-actions">
                        <button class="btn-copy" id="copyKeyBtn">
                            <i class="fas fa-copy"></i> COPY KEY
                        </button>
                        <button class="btn-clear" id="clearKeyBtn">
                            <i class="fas fa-trash"></i> CLEAR KEY
                        </button>
                        <button class="btn-back" id="backToMenuBtn">
                            <i class="fas fa-arrow-left"></i> BACK TO MENU
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="status-message" id="statusMessage"></div>
        </div>
    </div>

    <script>
        // ========== CONFIGURACI√ìN ==========
        const API_URL = window.location.origin;
        const SCREEN1_DURATION = 8000;
        const DISCORD_LINK = "https://discord.gg/TU_ENLACE_DISCORD";
        const TUTORIAL_LINK = "https://youtube.com/TU_ENLACE_TUTORIAL";
        const LINKVERTISE_URL = "https://link-hub.net/1457789/3pNxakfWICZQ";
        
        let particles = [];
        let animationId = null;
        let countdownInterval = null;
        
        // ========== SISTEMA DE PERSISTENCIA DE KEYS ==========
        function saveKeyToStorage(keyData) {
            const storageData = {
                key: keyData.key,
                created: keyData.created,
                expires_at: keyData.expires_at || (Date.now() + (keyData.expires_in * 1000)),
                expires_in: keyData.expires_in
            };
            
            localStorage.setItem('genesis_hub_key_data', JSON.stringify(storageData));
            console.log('üíæ Key guardada en localStorage');
        }
        
        function getSavedKey() {
            const saved = localStorage.getItem('genesis_hub_key_data');
            if (!saved) return null;
            
            try {
                const keyData = JSON.parse(saved);
                const now = Date.now();
                
                if (now < keyData.expires_at) {
                    const timeLeft = Math.floor((keyData.expires_at - now) / 1000);
                    const hours = Math.floor(timeLeft / 3600);
                    const minutes = Math.floor((timeLeft % 3600) / 60);
                    const seconds = timeLeft % 60;
                    
                    return {
                        ...keyData,
                        time_left: timeLeft,
                        formatted_time: `${hours}h ${minutes}m ${seconds}s`,
                        is_valid: true
                    };
                } else {
                    localStorage.removeItem('genesis_hub_key_data');
                    return null;
                }
            } catch {
                localStorage.removeItem('genesis_hub_key_data');
                return null;
            }
        }
        
        function startKeyCountdown(expiresIn) {
            if (countdownInterval) clearInterval(countdownInterval);
            
            let timeLeft = expiresIn;
            
            countdownInterval = setInterval(() => {
                timeLeft--;
                
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                    const status = document.getElementById('statusMessage');
                    if (status) {
                        status.textContent = '‚è∞ Key expired. Generate a new one.';
                        status.style.color = '#ff3300';
                    }
                    localStorage.removeItem('genesis_hub_key_data');
                } else {
                    const hours = Math.floor(timeLeft / 3600);
                    const minutes = Math.floor((timeLeft % 3600) / 60);
                    const seconds = timeLeft % 60;
                    
                    const status = document.getElementById('statusMessage');
                    if (status) {
                        status.textContent = `‚úÖ Key active. Expires in ${hours}h ${minutes}m ${seconds}s`;
                        status.style.color = '#ff6600';
                    }
                }
            }, 1000);
        }
        
        function displaySavedKey() {
            const savedKey = getSavedKey();
            if (savedKey && savedKey.is_valid) {
                const keyElement = document.getElementById('generatedKey');
                const resultDiv = document.getElementById('keyResult');
                const loading = document.getElementById('loadingKey');
                
                if (keyElement && resultDiv && loading) {
                    keyElement.textContent = savedKey.key;
                    loading.style.display = 'none';
                    resultDiv.style.display = 'block';
                    
                    startKeyCountdown(savedKey.time_left);
                    
                    return true;
                }
            }
            return false;
        }
        
        // ========== INICIALIZACI√ìN ==========
        document.addEventListener('DOMContentLoaded', function() {
            initParticles();
            setupEvents();
            
            setTimeout(() => {
                changeScreen(2);
            }, SCREEN1_DURATION);
            
            animateParticles();
        });
        
        function initParticles() {
            const container = document.getElementById('particles');
            const count = Math.min(30, Math.floor(window.innerWidth / 20));
            
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const size = Math.random() * 1.5 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.opacity = Math.random() * 0.5 + 0.3;
                
                particles.push({
                    element: particle,
                    x: parseFloat(particle.style.left),
                    y: parseFloat(particle.style.top),
                    speedX: (Math.random() - 0.5) * 0.2,
                    speedY: (Math.random() - 0.5) * 0.2
                });
                
                container.appendChild(particle);
            }
        }
        
        function animateParticles() {
            function update() {
                particles.forEach(p => {
                    p.x += p.speedX;
                    p.y += p.speedY;
                    
                    if (p.x < 0 || p.x > 100) p.speedX *= -1;
                    if (p.y < 0 || p.y > 100) p.speedY *= -1;
                    
                    p.x = Math.max(0, Math.min(100, p.x));
                    p.y = Math.max(0, Math.min(100, p.y));
                    
                    p.element.style.transform = `translate(${p.x}vw, ${p.y}vh)`;
                });
                
                animationId = requestAnimationFrame(update);
            }
            update();
        }
        
        // ========== EVENTOS ==========
        function setupEvents() {
            document.getElementById('createKeyBtn').addEventListener('click', () => {
                checkLinkvertiseBeforeGenerate();
            });
            
            document.getElementById('tutorialBtn').addEventListener('click', () => {
                window.open(TUTORIAL_LINK, '_blank');
            });
            
            document.getElementById('discordBtn').addEventListener('click', () => {
                window.open(DISCORD_LINK, '_blank');
            });
            
            document.getElementById('copyKeyBtn').addEventListener('click', copyKey);
            document.getElementById('clearKeyBtn').addEventListener('click', clearKey);
            document.getElementById('backToMenuBtn').addEventListener('click', () => {
                changeScreen(2);
            });
        }
        
         // ========== LINKVERTISE ==========
        async function checkLinkvertiseBeforeGenerate() {
            const status = document.getElementById('statusMessage');
            status.textContent = 'Checking Linkvertise...';
            status.style.color = '#ff6600';
            
            try {
                const response = await fetch(`${API_URL}/check-linkvertise`);
                const data = await response.json();
                
                if (data.completed) {
                    changeScreen(3);
                } else {
                    showLinkvertiseModal();
                }
            } catch (error) {
                console.error('Error:', error);
                showLinkvertiseModal();
            }
        }
        
        function showLinkvertiseModal() {
            const modal = document.createElement('div');
            modal.className = 'linkvertise-modal';
            
            modal.innerHTML = `
                <div class="modal-content">
                    <h2 class="modal-title">‚ö†Ô∏è LINKVERTISE REQUIRED</h2>
                    <p class="modal-text">
                        To generate a key, you must complete the Linkvertise.<br>
                        This helps support our project!
                    </p>
                    
                    <a href="${LINKVERTISE_URL}" target="_blank" class="linkvertise-btn" id="goToLinkvertiseBtn">
                        üîó GO TO LINKVERTISE
                    </a>
                    
                    <p class="modal-note">
                        Complete ALL steps, then return here and click "CREATE YOUR KEY" again.
                    </p>
                    
                    <button class="close-modal">Cancel</button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            const linkvertiseBtn = modal.querySelector('#goToLinkvertiseBtn');
            linkvertiseBtn.addEventListener('click', function(e) {
                e.preventDefault();
                const link = this.href;
                
                localStorage.setItem('linkvertise_start_time', Date.now().toString());
                window.open(link, '_blank');
                
                const modalText = modal.querySelector('.modal-text');
                modalText.innerHTML = `
                    <strong style="color:#ff6600">‚úÖ Linkvertise opened in new tab!</strong><br>
                    Complete all steps, then return here.
                `;
                
                linkvertiseBtn.textContent = '‚úÖ LINKVERTISE OPENED';
                linkvertiseBtn.style.background = 'linear-gradient(135deg, #00cc44, #009933)';
                linkvertiseBtn.style.pointerEvents = 'none';
                
                setTimeout(() => {
                    document.body.removeChild(modal);
                    
                    const status = document.getElementById('statusMessage');
                    if (status) {
                        status.textContent = 'Linkvertise opened. Complete it and return here.';
                        status.style.color = '#ff6600';
                    }
                }, 3000);
            });
            
            modal.querySelector('.close-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
                document.getElementById('statusMessage').textContent = 'Key generation cancelled';
                document.getElementById('statusMessage').style.color = '#ff3300';
            });
        }
        
        // ========== NAVEGACI√ìN ==========
        function changeScreen(screenNumber) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            
            setTimeout(() => {
                const screenElement = document.getElementById(`screen${screenNumber}`);
                if (screenElement) {
                    screenElement.classList.remove('hidden');
                }
                
                if (screenNumber === 3) {
                    // VER SI YA HAY KEY GUARDADA
                    if (!displaySavedKey()) {
                        generateKey();
                    }
                }
            }, 50);
        }
        
        // ========== GENERAR KEY ==========
        async function generateKey() {
            const loading = document.getElementById('loadingKey');
            const result = document.getElementById('keyResult');
            const keyElement = document.getElementById('generatedKey');
            const status = document.getElementById('statusMessage');
            
            loading.style.display = 'flex';
            result.style.display = 'none';
            status.textContent = '';
            status.style.color = '#aaa';
            
            try {
                const response = await fetch(`${API_URL}/generate-key`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        timestamp: Date.now(),
                        source: 'web_page'
                    })
                });
                
                const data = await response.json();
                
                setTimeout(() => {
                    loading.style.display = 'none';
                    
                    if (data.success && data.key) {
                        // MOSTRAR KEY
                        keyElement.textContent = data.key;
                        result.style.display = 'block';
                        
                        // GUARDAR EN STORAGE
                        saveKeyToStorage(data);
                        
                        // INICIAR CONTADOR
                        startKeyCountdown(data.expires_in);
                        
                        status.textContent = '‚úÖ Key generated! Copy and use in Roblox.';
                        status.style.color = '#ff6600';
                        
                        console.log(`üîë Key generada: ${data.key}`);
                        
                    } else {
                        status.textContent = data.message || 'Error generating key';
                        status.style.color = '#ff3300';
                        
                        if (data.error_code === 'LINKVERTISE_REQUIRED') {
                            showLinkvertiseModal();
                        }
                    }
                }, 1500);
                
            } catch (error) {
                setTimeout(() => {
                    loading.style.display = 'none';
                    status.textContent = '‚ö†Ô∏è Connection error. Try again.';
                    status.style.color = '#ff3300';
                }, 1500);
            }
        }
        
        // ========== COPIAR KEY ==========
        function copyKey() {
            const keyText = document.getElementById('generatedKey').textContent;
            
            if (keyText === 'ABC12-XYZ34-PQR56') return;
            
            navigator.clipboard.writeText(keyText).then(() => {
                const status = document.getElementById('statusMessage');
                status.textContent = '‚úÖ Key copied to clipboard!';
                status.style.color = '#00ff00';
                
                const copyBtn = document.getElementById('copyKeyBtn');
                const originalHTML = copyBtn.innerHTML;
                const originalBg = copyBtn.style.background;
                
                copyBtn.innerHTML = '<i class="fas fa-check"></i> COPIED!';
                copyBtn.style.background = 'linear-gradient(135deg, #00ff88, #00cc44)';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalHTML;
                    copyBtn.style.background = originalBg;
                }, 2000);
                
            }).catch(() => {
                document.getElementById('statusMessage').textContent = '‚ùå Failed to copy key';
                document.getElementById('statusMessage').style.color = '#ff3300';
            });
        }
        
        // ========== LIMPIAR KEY ==========
        function clearKey() {
            if (confirm('Are you sure you want to delete your current key? You will need to generate a new one.')) {
                localStorage.removeItem('genesis_hub_key_data');
                
                if (countdownInterval) clearInterval(countdownInterval);
                
                const resultDiv = document.getElementById('keyResult');
                const loading = document.getElementById('loadingKey');
                const status = document.getElementById('statusMessage');
                
                if (resultDiv) resultDiv.style.display = 'none';
                if (loading) loading.style.display = 'flex';
                if (status) {
                    status.textContent = 'üóëÔ∏è Key deleted. Generate a new one.';
                    status.style.color = '#ff6600';
                }
                
                console.log('üóëÔ∏è Key eliminada por usuario');
            }
        }
        
        // ========== LIMPIAR ==========
        window.addEventListener('beforeunload', function() {
            if (animationId) cancelAnimationFrame(animationId);
            if (countdownInterval) clearInterval(countdownInterval);
        });
    </script>
</body>
</html>
